# ğŸ‘‘ ç®¡ç†å‘˜é…ç½®æŒ‡å—

## ğŸ¯ å¿«é€Ÿé…ç½®æ­¥éª¤

### æ­¥éª¤1: éƒ¨ç½²åˆçº¦å¹¶è®°å½•ç®¡ç†å‘˜åœ°å€

```bash
cd contracts
npx hardhat run scripts/deploy.ts --network ganache
```

**æŸ¥çœ‹è¾“å‡ºä¿¡æ¯**ï¼Œæ‰¾åˆ°è¿™ä¸€è¡Œï¼š
```
ç®¡ç†å‘˜åœ°å€ï¼ˆå…¬è¯äººï¼‰: 0xABC...XYZ
```

**å¤åˆ¶è¿™ä¸ªåœ°å€**ï¼Œè¿™æ˜¯æ‚¨çš„ç®¡ç†å‘˜åœ°å€ï¼

### æ­¥éª¤2: è‡ªåŠ¨æ›´æ–°å‰ç«¯é…ç½®

```bash
node scripts/update-frontend-config.js
```

è¿™ä¸ªè„šæœ¬ä¼šè‡ªåŠ¨å°†ç®¡ç†å‘˜åœ°å€å†™å…¥å‰ç«¯é…ç½®æ–‡ä»¶ã€‚

### æ­¥éª¤3: éªŒè¯é…ç½®

æ‰“å¼€ `frontend/src/contracts/addresses.ts`ï¼Œåº”è¯¥çœ‹åˆ°ï¼š

```typescript
// éƒ¨ç½²åè‡ªåŠ¨ç”Ÿæˆçš„åˆçº¦åœ°å€
export const CONTRACT_ADDRESSES = {
  BetToken: "0x...",
  BetTicket: "0x...",
  BettingSystem: "0x..."
};

// ç®¡ç†å‘˜åœ°å€ï¼ˆå…¬è¯äººï¼‰
export const ADMIN_ADDRESS = "0xABC...XYZ";  // â† è¿™é‡Œåº”è¯¥æ˜¯å®é™…åœ°å€
```

### æ­¥éª¤4: åœ¨MetaMaskä¸­å¯¼å…¥ç®¡ç†å‘˜è´¦æˆ·

1. æ‰“å¼€MetaMask
2. ç‚¹å‡»è´¦æˆ·å›¾æ ‡ â†’ "å¯¼å…¥è´¦æˆ·"
3. åœ¨Ganacheä¸­æ‰¾åˆ°å¯¹åº”åœ°å€çš„ç§é’¥
4. ç²˜è´´ç§é’¥å¹¶å¯¼å…¥

### æ­¥éª¤5: å¯åŠ¨å‰ç«¯å¹¶æµ‹è¯•

```bash
cd frontend
npm start
```

## âœ… å¦‚ä½•éªŒè¯æ‚¨æ˜¯ç®¡ç†å‘˜

### è§†è§‰æ ‡è¯†

å½“ä½¿ç”¨ç®¡ç†å‘˜è´¦æˆ·ç™»å½•æ—¶ï¼Œæ‚¨ä¼šçœ‹åˆ°ï¼š

1. **é¡¶éƒ¨é‡‘è‰²å¾½ç« **
   ```
   ğŸ° å»ä¸­å¿ƒåŒ–å½©ç¥¨ç³»ç»Ÿ
   ğŸ‘‘ ç®¡ç†å‘˜ï¼ˆå…¬è¯äººï¼‰  â† é‡‘è‰²é—ªåŠ¨çš„å¾½ç« 
   ```

2. **åˆ›å»ºé¡¹ç›®æ ‡ç­¾**
   ```
   [ğŸ“‹ æ‰€æœ‰é¡¹ç›®] [â• åˆ›å»ºé¡¹ç›®] [ğŸ« æˆ‘çš„å½©ç¥¨] [ğŸ›’ äº¤æ˜“å¸‚åœº]
                  â†‘ åªæœ‰ç®¡ç†å‘˜èƒ½çœ‹åˆ°
   ```

3. **åˆ›å»ºé¡µé¢çš„æé†’**
   ```
   â• åˆ›å»ºç«çŒœé¡¹ç›®
   [ğŸ‘‘ æ‚¨æ­£åœ¨ä»¥ç®¡ç†å‘˜èº«ä»½åˆ›å»ºç«çŒœé¡¹ç›®]
   ```

### åŠŸèƒ½å·®å¼‚

| åŠŸèƒ½ | æ™®é€šç”¨æˆ· | ç®¡ç†å‘˜ |
|------|---------|--------|
| æŸ¥çœ‹é¡¹ç›® | âœ… | âœ… |
| è´­ä¹°å½©ç¥¨ | âœ… | âœ… |
| äº¤æ˜“å½©ç¥¨ | âœ… | âœ… |
| **åˆ›å»ºé¡¹ç›®** | âŒ | âœ… |
| **ç»“ç®—é¡¹ç›®** | âŒ | âœ…ï¼ˆä»…è‡ªå·±åˆ›å»ºçš„ï¼‰ |
| é¢†å–ä»£å¸ | âœ… | âœ… |

## ğŸ”§ æ‰‹åŠ¨é…ç½®ï¼ˆé«˜çº§ï¼‰

å¦‚æœè‡ªåŠ¨é…ç½®å¤±è´¥ï¼Œå¯ä»¥æ‰‹åŠ¨è®¾ç½®ï¼š

### æ–¹æ³•1: ä¿®æ”¹é…ç½®æ–‡ä»¶

ç¼–è¾‘ `frontend/src/contracts/addresses.ts`ï¼š

```typescript
export const ADMIN_ADDRESS = "0xæ‚¨ä»Ganacheå¤åˆ¶çš„åœ°å€";
```

**é‡è¦**ï¼šåœ°å€å¿…é¡»å®Œå…¨åŒ¹é…ï¼ˆä½†ä¸åŒºåˆ†å¤§å°å†™ï¼‰

### æ–¹æ³•2: ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰

åœ¨ `frontend/.env` ä¸­æ·»åŠ ï¼š

```
REACT_APP_ADMIN_ADDRESS=0xæ‚¨çš„ç®¡ç†å‘˜åœ°å€
```

ç„¶ååœ¨ `addresses.ts` ä¸­ï¼š

```typescript
export const ADMIN_ADDRESS = process.env.REACT_APP_ADMIN_ADDRESS || "0xdefault";
```

## ğŸ­ å¤šç®¡ç†å‘˜æ”¯æŒï¼ˆæ‰©å±•ï¼‰

å¦‚æœéœ€è¦å¤šä¸ªç®¡ç†å‘˜ï¼Œå¯ä»¥ä¿®æ”¹ `App.tsx`ï¼š

```typescript
// å®šä¹‰ç®¡ç†å‘˜åˆ—è¡¨
const ADMIN_ADDRESSES = [
  "0xç¬¬ä¸€ä¸ªç®¡ç†å‘˜åœ°å€",
  "0xç¬¬äºŒä¸ªç®¡ç†å‘˜åœ°å€",
  "0xç¬¬ä¸‰ä¸ªç®¡ç†å‘˜åœ°å€"
].map(addr => addr.toLowerCase());

// ä¿®æ”¹åˆ¤æ–­é€»è¾‘
const isAdmin = ADMIN_ADDRESSES.includes(account.toLowerCase());
```

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜1: çœ‹ä¸åˆ°ç®¡ç†å‘˜å¾½ç« 

**æ£€æŸ¥æ¸…å•**ï¼š
- [ ] ç¡®è®¤å·²è¿è¡Œ `update-frontend-config.js`
- [ ] æ‰“å¼€ `addresses.ts` ç¡®è®¤ `ADMIN_ADDRESS` ä¸æ˜¯ "0xYOUR..."
- [ ] æ£€æŸ¥MetaMaskä¸­çš„è´¦æˆ·åœ°å€æ˜¯å¦ä¸é…ç½®åŒ¹é…
- [ ] åˆ·æ–°æµè§ˆå™¨é¡µé¢ï¼ˆCtrl+F5 å¼ºåˆ¶åˆ·æ–°ï¼‰
- [ ] æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯

**è°ƒè¯•æ–¹æ³•**ï¼š

åœ¨æµè§ˆå™¨æ§åˆ¶å°è¾“å…¥ï¼š
```javascript
console.log("å½“å‰è´¦æˆ·:", window.ethereum.selectedAddress);
console.log("ç®¡ç†å‘˜åœ°å€:", "ä»addresses.tså¤åˆ¶çš„åœ°å€");
console.log("æ˜¯å¦åŒ¹é…:", window.ethereum.selectedAddress.toLowerCase() === "ç®¡ç†å‘˜åœ°å€".toLowerCase());
```

### é—®é¢˜2: é…ç½®æ–‡ä»¶æœªæ›´æ–°

æ‰‹åŠ¨è¿è¡Œï¼š
```bash
cd contracts
node scripts/update-frontend-config.js
```

å¦‚æœæŠ¥é”™"æ‰¾ä¸åˆ°æ–‡ä»¶"ï¼Œæ£€æŸ¥ï¼š
- [ ] `contract-addresses.json` æ˜¯å¦å­˜åœ¨äº `contracts/` ç›®å½•
- [ ] æ˜¯å¦å·²æˆåŠŸéƒ¨ç½²åˆçº¦

### é—®é¢˜3: ä¸¤ä¸ªè´¦æˆ·éƒ½æ˜¾ç¤ºç®¡ç†å‘˜

**åŸå› **ï¼šé…ç½®äº†é”™è¯¯çš„åœ°å€

**è§£å†³**ï¼š
1. è¿è¡Œ `npx hardhat run scripts/deploy.ts --network ganache` 
2. è®°å½•è¾“å‡ºçš„ç®¡ç†å‘˜åœ°å€
3. æ‰‹åŠ¨ç¼–è¾‘ `frontend/src/contracts/addresses.ts`
4. é‡å¯å‰ç«¯

## ğŸ“‹ å®Œæ•´æ£€æŸ¥æµç¨‹

```bash
# 1. ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•
pwd  # åº”è¯¥æ˜¾ç¤º .../ZJU-blockchain-course-2025

# 2. éƒ¨ç½²åˆçº¦
cd contracts
npx hardhat run scripts/deploy.ts --network ganache
# â† è®°å½•è¾“å‡ºçš„ç®¡ç†å‘˜åœ°å€

# 3. æ›´æ–°å‰ç«¯é…ç½®
node scripts/update-frontend-config.js

# 4. æ£€æŸ¥é…ç½®æ–‡ä»¶
cat ../frontend/src/contracts/addresses.ts
# â† ç¡®è®¤ ADMIN_ADDRESS æ˜¯æ­£ç¡®çš„

# 5. å¯åŠ¨å‰ç«¯
cd ../frontend
npm start

# 6. åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•
# - æ‰“å¼€ http://localhost:3000
# - è¿æ¥ç®¡ç†å‘˜è´¦æˆ·
# - åº”è¯¥çœ‹åˆ°é‡‘è‰²å¾½ç« å’Œåˆ›å»ºé¡¹ç›®æŒ‰é’®
```

## ğŸ¯ æœ€ä½³å®è·µ

1. **ä½¿ç”¨ç¬¬ä¸€ä¸ªGanacheè´¦æˆ·ä½œä¸ºç®¡ç†å‘˜**
   - åœ°å€å›ºå®šï¼Œæ˜“äºè¯†åˆ«
   - é»˜è®¤æœ‰æœ€å¤šçš„ETH

2. **ä¿å­˜ç®¡ç†å‘˜ç§é’¥**
   - åœ¨å®‰å…¨çš„åœ°æ–¹è®°å½•
   - æµ‹è¯•ç¯å¢ƒå¯ä»¥å†™åœ¨æ–‡æ¡£ä¸­

3. **æµ‹è¯•ç”¨å…¶ä»–è´¦æˆ·**
   - è‡³å°‘å¯¼å…¥3ä¸ªGanacheè´¦æˆ·åˆ°MetaMask
   - ä¸€ä¸ªåšç®¡ç†å‘˜ï¼Œå…¶ä»–åšæ™®é€šç”¨æˆ·
   - ä¾¿äºæµ‹è¯•å½©ç¥¨äº¤æ˜“åŠŸèƒ½

4. **é‡æ–°éƒ¨ç½²æ—¶è®°å¾—æ›´æ–°é…ç½®**
   ```bash
   npx hardhat run scripts/deploy.ts --network ganache
   node scripts/update-frontend-config.js
   # é‡å¯å‰ç«¯
   ```

## ğŸ” å®‰å…¨æç¤º

âš ï¸ **æ³¨æ„**ï¼šå½“å‰å®ç°åªåœ¨å‰ç«¯é™åˆ¶äº†åˆ›å»ºé¡¹ç›®æŒ‰é’®çš„æ˜¾ç¤º

å¦‚æœéœ€è¦åœ¨åˆçº¦å±‚é¢é™åˆ¶ï¼Œéœ€è¦ä¿®æ”¹ `BettingSystem.sol`ï¼š

```solidity
address public admin;

constructor(...) {
    admin = msg.sender;
}

function createProject(...) external {
    require(msg.sender == admin, "Only admin can create projects");
    // ... å…¶ä½™ä»£ç 
}
```

ä½†å¯¹äºä½œä¸šæ¼”ç¤ºï¼Œå‰ç«¯é™åˆ¶å·²ç»è¶³å¤Ÿï¼

## âœ… éªŒæ”¶æ£€æŸ¥

ä½¿ç”¨ä»¥ä¸‹æ¸…å•éªŒè¯é…ç½®æˆåŠŸï¼š

**ç®¡ç†å‘˜è´¦æˆ·ç™»å½•æ—¶**ï¼š
- [ ] çœ‹åˆ°é‡‘è‰²ğŸ‘‘å¾½ç« 
- [ ] çœ‹åˆ°"â• åˆ›å»ºé¡¹ç›®"æ ‡ç­¾
- [ ] å¯ä»¥è¿›å…¥åˆ›å»ºé¡µé¢
- [ ] çœ‹åˆ°"ğŸ‘‘ æ‚¨æ­£åœ¨ä»¥ç®¡ç†å‘˜èº«ä»½åˆ›å»ºç«çŒœé¡¹ç›®"æç¤º
- [ ] å¯ä»¥åˆ›å»ºæ–°é¡¹ç›®
- [ ] åœ¨é¡¹ç›®åˆ—è¡¨ä¸­çœ‹åˆ°"æˆ‘åˆ›å»ºçš„"æ ‡ç­¾
- [ ] å¯ä»¥ç»“ç®—è‡ªå·±åˆ›å»ºçš„é¡¹ç›®

**æ™®é€šè´¦æˆ·ç™»å½•æ—¶**ï¼š
- [ ] æ²¡æœ‰é‡‘è‰²å¾½ç« 
- [ ] æ²¡æœ‰"åˆ›å»ºé¡¹ç›®"æ ‡ç­¾
- [ ] æ— æ³•çœ‹åˆ°ç»“ç®—æŒ‰é’®ï¼ˆé™¤éé¡¹ç›®ä¸æ˜¯è‡ªå·±åˆ›å»ºçš„ï¼‰
- [ ] å¯ä»¥æ­£å¸¸è´­ä¹°ã€äº¤æ˜“å½©ç¥¨

---

é…ç½®å®Œæˆåï¼Œæ‚¨å°±å¯ä»¥å®Œæ•´ä½“éªŒç®¡ç†å‘˜åŠŸèƒ½äº†ï¼ğŸ‰

