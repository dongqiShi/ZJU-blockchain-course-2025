# ğŸ“ é¡¹ç›®ç»“æ„è¯´æ˜

## å®Œæ•´é¡¹ç›®ç»“æ„

```
ZJU-blockchain-course-2025/
â”‚
â”œâ”€â”€ contracts/                              # æ™ºèƒ½åˆçº¦ç›®å½•
â”‚   â”œâ”€â”€ contracts/                          # Solidity åˆçº¦æºç 
â”‚   â”‚   â”œâ”€â”€ BetToken.sol                   # âœ… ERC20 ç§¯åˆ†ä»£å¸åˆçº¦
â”‚   â”‚   â”œâ”€â”€ BetTicket.sol                  # âœ… ERC721 å½©ç¥¨å‡­è¯åˆçº¦
â”‚   â”‚   â”œâ”€â”€ BettingSystem.sol              # âœ… ä¸»å½©ç¥¨ç³»ç»Ÿåˆçº¦
â”‚   â”‚   â””â”€â”€ EasyBet.sol                    # ï¼ˆåŸå§‹æ¨¡æ¿ï¼Œå¯å¿½ç•¥ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ scripts/                           # éƒ¨ç½²å’Œå·¥å…·è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ deploy.ts                      # âœ… è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬
â”‚   â”‚   â””â”€â”€ update-frontend-config.js      # âœ… å‰ç«¯é…ç½®æ›´æ–°å·¥å…·
â”‚   â”‚
â”‚   â”œâ”€â”€ test/                              # æµ‹è¯•æ–‡ä»¶ï¼ˆå¯è‡ªè¡Œæ·»åŠ ï¼‰
â”‚   â”‚   â””â”€â”€ testEasyBet.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ artifacts/                         # ç¼–è¯‘äº§ç‰©ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â”‚   â””â”€â”€ contracts/                     # åŒ…å« ABI å’Œå­—èŠ‚ç 
â”‚   â”‚
â”‚   â”œâ”€â”€ typechain-types/                   # TypeScript ç±»å‹å®šä¹‰ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ cache/                             # ç¼–è¯‘ç¼“å­˜ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ hardhat.config.ts                  # âš™ï¸ Hardhat é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ tsconfig.json                      # TypeScript é…ç½®
â”‚   â”œâ”€â”€ package.json                       # Node.js ä¾èµ–é…ç½®
â”‚   â”œâ”€â”€ package-lock.json                  # ä¾èµ–é”å®šæ–‡ä»¶
â”‚   â””â”€â”€ contract-addresses.json            # ğŸ“ éƒ¨ç½²åçš„åˆçº¦åœ°å€ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚
â”œâ”€â”€ frontend/                              # å‰ç«¯åº”ç”¨ç›®å½•
â”‚   â”œâ”€â”€ public/                            # é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ index.html                     # HTML æ¨¡æ¿
â”‚   â”‚   â”œâ”€â”€ favicon.ico                    # ç½‘ç«™å›¾æ ‡
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ src/                               # æºä»£ç 
â”‚   â”‚   â”œâ”€â”€ contracts/                     # åˆçº¦é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ addresses.ts               # âœ… åˆçº¦åœ°å€é…ç½®
â”‚   â”‚   â”‚   â””â”€â”€ abis.ts                    # âœ… åˆçº¦ ABI å®šä¹‰
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ App.tsx                        # âœ… ä¸»åº”ç”¨ç»„ä»¶ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰
â”‚   â”‚   â”œâ”€â”€ App.css                        # âœ… åº”ç”¨æ ·å¼
â”‚   â”‚   â”œâ”€â”€ index.tsx                      # React å…¥å£
â”‚   â”‚   â”œâ”€â”€ index.css                      # å…¨å±€æ ·å¼
â”‚   â”‚   â”œâ”€â”€ react-app-env.d.ts            # React ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ node_modules/                      # ä¾èµ–åŒ…ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â”œâ”€â”€ package.json                       # ä¾èµ–é…ç½®
â”‚   â”œâ”€â”€ package-lock.json                  # ä¾èµ–é”å®š
â”‚   â””â”€â”€ tsconfig.json                      # TypeScript é…ç½®
â”‚
â”œâ”€â”€ README.md                              # ğŸ“– é¡¹ç›®è¯´æ˜ï¼ˆå·²å®Œå–„ï¼‰
â”œâ”€â”€ ä½¿ç”¨è¯´æ˜æ–‡æ¡£.md                        # ğŸ“š è¯¦ç»†ä½¿ç”¨æ•™ç¨‹ï¼ˆ50+ é¡µï¼‰
â”œâ”€â”€ å¿«é€Ÿå¯åŠ¨æŒ‡å—.md                        # ğŸš€ å¿«é€Ÿå‚è€ƒ
â”œâ”€â”€ é¡¹ç›®æ€»ç»“.md                            # ğŸ“Š é¡¹ç›®æ€»ç»“
â””â”€â”€ é¡¹ç›®ç»“æ„è¯´æ˜.md                        # ğŸ“ æœ¬æ–‡æ¡£
```

## ğŸ¯ æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

### æ™ºèƒ½åˆçº¦æ–‡ä»¶

#### 1. BetToken.sol
**ä½œç”¨**: ERC20 ç§¯åˆ†ä»£å¸åˆçº¦

**ä¸»è¦åŠŸèƒ½**:
- `claimTokens()`: ç”¨æˆ·é¢†å–å…è´¹ä»£å¸
- `getRemainingClaims()`: æŸ¥è¯¢å‰©ä½™é¢†å–æ¬¡æ•°
- æ ‡å‡† ERC20 åŠŸèƒ½ï¼ˆtransfer, approve, balanceOf ç­‰ï¼‰

**å…³é”®ç‰¹æ€§**:
- æ¯æ¬¡é¢†å– 1000 BET
- æ¯åœ°å€æœ€å¤šé¢†å– 10 æ¬¡
- ä½¿ç”¨ OpenZeppelin ERC20 æ ‡å‡†

#### 2. BetTicket.sol
**ä½œç”¨**: ERC721 å½©ç¥¨å‡­è¯åˆçº¦

**ä¸»è¦åŠŸèƒ½**:
- `mintTicket()`: é“¸é€ å½©ç¥¨ NFTï¼ˆä»…ç³»ç»Ÿè°ƒç”¨ï¼‰
- `getTicketInfo()`: æŸ¥è¯¢å½©ç¥¨ä¿¡æ¯
- `getTicketsOfOwner()`: æŸ¥è¯¢ç”¨æˆ·æ‰€æœ‰å½©ç¥¨
- æ ‡å‡† ERC721 åŠŸèƒ½

**å…³é”®ç‰¹æ€§**:
- æ¯å¼ å½©ç¥¨æ˜¯å”¯ä¸€çš„ NFT
- è®°å½•é¡¹ç›® ID å’Œé€‰é¡¹ç´¢å¼•
- æ”¯æŒè½¬è®©å’Œäº¤æ˜“

#### 3. BettingSystem.sol
**ä½œç”¨**: ä¸»å½©ç¥¨ç³»ç»Ÿåˆçº¦ï¼ˆæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼‰

**ä¸»è¦åŠŸèƒ½**:
- `createProject()`: åˆ›å»ºç«çŒœé¡¹ç›®
- `purchaseTicket()`: è´­ä¹°å½©ç¥¨
- `createSellOrder()`: åˆ›å»ºå‡ºå”®è®¢å•
- `buyTicketFromOrder()`: è´­ä¹°è®¢å•ä¸­çš„å½©ç¥¨
- `settleProject()`: ç»“ç®—é¡¹ç›®
- `claimReward()`: é¢†å–å¥–åŠ±
- `getProjectInfo()`: æŸ¥è¯¢é¡¹ç›®ä¿¡æ¯
- `getProjectOrders()`: æŸ¥è¯¢è®¢å•ç°¿

**å…³é”®ç‰¹æ€§**:
- ç®¡ç†é¡¹ç›®ç”Ÿå‘½å‘¨æœŸ
- å®ç°é“¾ä¸Šè®¢å•ç°¿
- å¤„ç†å¥–åŠ±åˆ†é…
- ReentrancyGuard é˜²æŠ¤

### éƒ¨ç½²è„šæœ¬

#### deploy.ts
**ä½œç”¨**: è‡ªåŠ¨åŒ–éƒ¨ç½²æ‰€æœ‰åˆçº¦

**æµç¨‹**:
1. éƒ¨ç½² BetToken
2. éƒ¨ç½² BetTicket
3. éƒ¨ç½² BettingSystem
4. è½¬ç§» BetTicket æ‰€æœ‰æƒç»™ BettingSystem
5. ä¿å­˜åˆçº¦åœ°å€åˆ° `contract-addresses.json`

#### update-frontend-config.js
**ä½œç”¨**: åŒæ­¥åˆçº¦åœ°å€åˆ°å‰ç«¯

**æµç¨‹**:
1. è¯»å– `contract-addresses.json`
2. æ›´æ–° `frontend/src/contracts/addresses.ts`
3. ç¡®ä¿å‰ç«¯ä½¿ç”¨æœ€æ–°çš„åˆçº¦åœ°å€

### å‰ç«¯æ–‡ä»¶

#### App.tsx
**ä½œç”¨**: ä¸»åº”ç”¨ç»„ä»¶ï¼ˆ2000+ è¡Œä»£ç ï¼‰

**åŠŸèƒ½æ¨¡å—**:
1. **é’±åŒ…è¿æ¥**: MetaMask é›†æˆ
2. **æ‰€æœ‰é¡¹ç›®**: æµè§ˆå’Œè´­ä¹°å½©ç¥¨
3. **åˆ›å»ºé¡¹ç›®**: å…¬è¯äººåˆ›å»ºç«çŒœ
4. **æˆ‘çš„å½©ç¥¨**: ç®¡ç†å’Œå‡ºå”®å½©ç¥¨
5. **äº¤æ˜“å¸‚åœº**: è®¢å•ç°¿æŸ¥çœ‹å’Œè´­ä¹°

**æ ¸å¿ƒ Hooks**:
- `useState`: ç®¡ç†åº”ç”¨çŠ¶æ€
- `useEffect`: ç›‘å¬è´¦æˆ·å˜åŒ–
- è‡ªå®šä¹‰åŠ è½½å‡½æ•°ï¼ˆloadBalance, loadProjects ç­‰ï¼‰

#### App.css
**ä½œç”¨**: åº”ç”¨æ ·å¼ï¼ˆ800+ è¡Œ CSSï¼‰

**è®¾è®¡ç‰¹ç‚¹**:
- æ¸å˜è‰²ä¸»é¢˜ï¼ˆç´«è‰²ç³»ï¼‰
- å“åº”å¼è®¾è®¡
- å¡ç‰‡å¼å¸ƒå±€
- ç°ä»£åŒ– UI ç»„ä»¶

#### contracts/addresses.ts
**ä½œç”¨**: åˆçº¦åœ°å€é…ç½®

**å†…å®¹**:
```typescript
export const CONTRACT_ADDRESSES = {
  BetToken: "0x...",
  BetTicket: "0x...",
  BettingSystem: "0x..."
};
```

#### contracts/abis.ts
**ä½œç”¨**: åˆçº¦ ABI å®šä¹‰

**å†…å®¹**: ä½¿ç”¨ ethers.js çš„ Human-Readable ABI æ ¼å¼

### é…ç½®æ–‡ä»¶

#### hardhat.config.ts
**ä½œç”¨**: Hardhat å¼€å‘ç¯å¢ƒé…ç½®

**é…ç½®å†…å®¹**:
- Solidity ç‰ˆæœ¬: 0.8.20
- Ganache ç½‘ç»œé…ç½®
- è´¦æˆ·ç§é’¥è®¾ç½®

#### package.jsonï¼ˆcontractsï¼‰
**ä¸»è¦ä¾èµ–**:
- hardhat: ^2.26.3
- @openzeppelin/contracts: ^5.0.0
- @nomicfoundation/hardhat-toolbox: ^2.0.2

#### package.jsonï¼ˆfrontendï¼‰
**ä¸»è¦ä¾èµ–**:
- react: ^19.2.0
- ethers: ^5.7.2
- typescript: ^4.9.5

## ğŸ“ æ–‡æ¡£æ–‡ä»¶

### README.md
- é¡¹ç›®ç®€ä»‹
- è¿è¡Œæ­¥éª¤
- åŠŸèƒ½å®ç°åˆ†æ

### ä½¿ç”¨è¯´æ˜æ–‡æ¡£.md
- è¯¦ç»†å®‰è£…é…ç½®ï¼ˆ50+ é¡µï¼‰
- å®Œæ•´ä½¿ç”¨æ•™ç¨‹
- å¸¸è§é—®é¢˜è§£ç­”
- æµ‹è¯•æµç¨‹ç¤ºä¾‹

### å¿«é€Ÿå¯åŠ¨æŒ‡å—.md
- ä¸€é¡µå¿«é€Ÿå‚è€ƒ
- å¸¸è§é—®é¢˜é€ŸæŸ¥

### é¡¹ç›®æ€»ç»“.md
- é¡¹ç›®æ¦‚å†µ
- æŠ€æœ¯æ¶æ„
- æ ¸å¿ƒäº®ç‚¹

### é¡¹ç›®ç»“æ„è¯´æ˜.md
- æœ¬æ–‡æ¡£
- é¡¹ç›®æ–‡ä»¶æ ‘
- æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

## ğŸ”„ æ–‡ä»¶ä¾èµ–å…³ç³»

```
éƒ¨ç½²æµç¨‹:
deploy.ts
  â†’ éƒ¨ç½²ä¸‰ä¸ªåˆçº¦
  â†’ ç”Ÿæˆ contract-addresses.json
  â†’ update-frontend-config.js
    â†’ æ›´æ–° frontend/src/contracts/addresses.ts

è¿è¡Œæµç¨‹:
Ganache (æœ¬åœ°é“¾)
  â†“
hardhat.config.ts (è¿æ¥é…ç½®)
  â†“
BettingSystem.sol (è°ƒç”¨)
  â†“
BetToken.sol & BetTicket.sol (ä¾èµ–)
  â†“
frontend/App.tsx (é€šè¿‡ ethers.js)
  â†“
MetaMask (ç”¨æˆ·é’±åŒ…)
```

## ğŸ“Š ä»£ç ç»Ÿè®¡

| æ–‡ä»¶ | è¡Œæ•° | è¯´æ˜ |
|------|------|------|
| BetToken.sol | ~50 | ERC20 åˆçº¦ |
| BetTicket.sol | ~80 | ERC721 åˆçº¦ |
| BettingSystem.sol | ~400 | ä¸»ç³»ç»Ÿåˆçº¦ |
| App.tsx | ~600 | å‰ç«¯ä¸»ç»„ä»¶ |
| App.css | ~500 | æ ·å¼æ–‡ä»¶ |
| deploy.ts | ~60 | éƒ¨ç½²è„šæœ¬ |

**æ€»è®¡**: ~1,700 è¡Œæ ¸å¿ƒä»£ç 

## ğŸ¯ å…³é”®è·¯å¾„

### ç¬¬ä¸€æ¬¡è¿è¡Œ
1. `contracts/hardhat.config.ts` - é…ç½® Ganache
2. `contracts/scripts/deploy.ts` - éƒ¨ç½²åˆçº¦
3. `contracts/scripts/update-frontend-config.js` - æ›´æ–°é…ç½®
4. `frontend/src/App.tsx` - å¯åŠ¨å‰ç«¯

### æ—¥å¸¸å¼€å‘
1. ä¿®æ”¹åˆçº¦ â†’ `npx hardhat compile`
2. é‡æ–°éƒ¨ç½² â†’ `npx hardhat run scripts/deploy.ts --network ganache`
3. æ›´æ–°é…ç½® â†’ `node scripts/update-frontend-config.js`
4. é‡å¯å‰ç«¯ â†’ `npm start`

## ğŸ’¡ æœ€ä½³å®è·µ

### å¼€å‘å»ºè®®
1. **ä¿®æ”¹åˆçº¦åå¿…é¡»**:
   - é‡æ–°ç¼–è¯‘
   - é‡æ–°éƒ¨ç½²
   - æ›´æ–°å‰ç«¯é…ç½®
   - é‡å¯å‰ç«¯

2. **åˆ‡æ¢ç½‘ç»œæ—¶**:
   - æ£€æŸ¥ MetaMask ç½‘ç»œ
   - ç¡®è®¤ RPC åœ°å€
   - éªŒè¯åˆçº¦åœ°å€

3. **é‡åˆ°é—®é¢˜æ—¶**:
   - æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°
   - æ£€æŸ¥ MetaMask è¿æ¥
   - ç¡®è®¤è´¦æˆ·ä½™é¢

### æ–‡ä»¶ç®¡ç†
- âœ… ä¿ç•™: æ‰€æœ‰ .sol, .ts, .tsx æ–‡ä»¶
- âœ… å¯åˆ é™¤é‡æ–°ç”Ÿæˆ: artifacts/, cache/, typechain-types/, node_modules/
- âš ï¸ æ³¨æ„: contract-addresses.json åŒ…å«éƒ¨ç½²åœ°å€ï¼Œåˆ é™¤åéœ€é‡æ–°éƒ¨ç½²

## ğŸ“ å­¦ä¹ è·¯å¾„

**æ–°æ‰‹**: 
1. é˜…è¯» `å¿«é€Ÿå¯åŠ¨æŒ‡å—.md`
2. æŒ‰æ­¥éª¤è¿è¡Œé¡¹ç›®
3. æŸ¥çœ‹ `ä½¿ç”¨è¯´æ˜æ–‡æ¡£.md` äº†è§£åŠŸèƒ½

**è¿›é˜¶**:
1. é˜…è¯» `BettingSystem.sol` ç†è§£ä¸šåŠ¡é€»è¾‘
2. ç ”ç©¶ `App.tsx` å­¦ä¹  Web3 å‰ç«¯
3. ä¿®æ”¹åŠŸèƒ½å¹¶é‡æ–°éƒ¨ç½²æµ‹è¯•

**ä¸“å®¶**:
1. æ‰©å±•åˆçº¦åŠŸèƒ½ï¼ˆæ·»åŠ æ–°çš„ç«çŒœç±»å‹ï¼‰
2. ä¼˜åŒ–è®¢å•ç°¿æ€§èƒ½
3. æ·»åŠ æ›´å¤šå‰ç«¯åŠŸèƒ½ï¼ˆå›¾è¡¨ã€ç»Ÿè®¡ç­‰ï¼‰

---

é¡¹ç›®ç»“æ„æ¸…æ™°ï¼Œæ–‡æ¡£å®Œæ•´ï¼Œé€‚åˆå­¦ä¹ å’Œæ‰©å±•ï¼

